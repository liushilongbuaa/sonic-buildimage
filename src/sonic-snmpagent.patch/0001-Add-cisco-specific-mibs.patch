From 145ebf619195c2ffff619d031a3c05c92004d5a6 Mon Sep 17 00:00:00 2001
From: Qi Luo <qiluo-msft@users.noreply.github.com>
Date: Wed, 15 Mar 2017 21:42:10 +0000
Subject: [PATCH] Add cisco specific mibs

---
 src/sonic_ax_impl/main.py                       |  3 +-
 src/sonic_ax_impl/mibs/vendor/cisco/__init__.py |  1 +
 src/sonic_ax_impl/mibs/vendor/cisco/mgmt.py     | 40 +++++++++++++++++++++++++
 3 files changed, 43 insertions(+), 1 deletion(-)
 create mode 100644 src/sonic_ax_impl/mibs/vendor/cisco/__init__.py
 create mode 100644 src/sonic_ax_impl/mibs/vendor/cisco/mgmt.py

diff --git a/src/sonic_ax_impl/main.py b/src/sonic_ax_impl/main.py
index 2309860..26a46e4 100644
--- a/src/sonic_ax_impl/main.py
+++ b/src/sonic_ax_impl/main.py
@@ -12,7 +12,7 @@ import ax_interface
 from sonic_ax_impl.mibs import ieee802_1ab
 from . import logger
 from .mibs.ietf import rfc1213, rfc2863, rfc4292, rfc4363
-from .mibs.vendor import dell
+from .mibs.vendor import dell, cisco
 
 # Background task update frequency ( in seconds )
 DEFAULT_UPDATE_FREQUENCY = 5
@@ -29,6 +29,7 @@ class SonicMIB(
     ieee802_1ab.LLDPLocPortTable,
     ieee802_1ab.LLDPRemTable,
     dell.force10.SSeriesMIB,
+    cisco.mgmt.CiscoSystemExtMIB,
 ):
     """
     If SONiC was to create custom MIBEntries, they may be specified here.
diff --git a/src/sonic_ax_impl/mibs/vendor/cisco/__init__.py b/src/sonic_ax_impl/mibs/vendor/cisco/__init__.py
new file mode 100644
index 0000000..5a7a784
--- /dev/null
+++ b/src/sonic_ax_impl/mibs/vendor/cisco/__init__.py
@@ -0,0 +1 @@
+from . import mgmt
\ No newline at end of file
diff --git a/src/sonic_ax_impl/mibs/vendor/cisco/mgmt.py b/src/sonic_ax_impl/mibs/vendor/cisco/mgmt.py
new file mode 100644
index 0000000..10c0a3d
--- /dev/null
+++ b/src/sonic_ax_impl/mibs/vendor/cisco/mgmt.py
@@ -0,0 +1,40 @@
+from sonic_ax_impl.mibs.vendor import sys_util_h
+from ax_interface import MIBMeta, ValueType
+from ax_interface.mib import MIBEntry
+
+
+class CiscoSystemExtMIB(metaclass=MIBMeta, prefix='.1.3.6.1.4.1.9.9.305'):
+    """
+    {iso(1) identified-organization(3) dod(6) internet(1) private(4) enterprise(1) 9 ciscoMgmt(9)
+    CISCO-SYSTEM-EXT-MIB (305)}
+
+    OID_cseSysMemoryUtilization = "1.3.6.1.4.1.9.9.305.1.1.2.0";
+    OID_cseSysCPUUtilization = "1.3.6.1.4.1.9.9.305.1.1.1.0";
+    """
+    updater = sys_util_h
+
+    """
+    cseSysMemoryUtilization OBJECT-TYPE
+    SYNTAX          Gauge32 (0..100 )
+    UNITS           "%"
+    MAX-ACCESS      read-only
+    STATUS          current
+    DESCRIPTION
+        "The average utilization of memory on the active
+        supervisor."
+    ::= { ciscoSysInfoGroup 2 }
+    """
+    cseSysMemoryUtilization = MIBEntry('1.1.2.0', ValueType.GAUGE_32, sys_util_h.get_memutil)
+
+    """
+    cseSysCPUUtilization OBJECT-TYPE
+    SYNTAX          Gauge32 (0..100 )
+    UNITS           "%"
+    MAX-ACCESS      read-only
+    STATUS          current
+    DESCRIPTION
+        "The average utilization of CPU on the active
+        supervisor."
+    ::= { ciscoSysInfoGroup 1 }
+    """
+    cseSysCPUUtilization = MIBEntry('1.1.1.0', ValueType.GAUGE_32, sys_util_h.get_cpuutil_5sec)
-- 
2.11.0

