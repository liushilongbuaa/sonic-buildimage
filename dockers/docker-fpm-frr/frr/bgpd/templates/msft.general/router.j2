{% macro general_routing(template_name) %}
{% set device_type = CONFIG_DB__DEVICE_METADATA['localhost']['type'] %}
{% set deployment_id = CONFIG_DB__DEVICE_METADATA['localhost']['deployment_id'] %}
{% set resource_type = CONFIG_DB__DEVICE_METADATA['localhost']['resource_type'] %}
{% set neighbor_type = CONFIG_DB__DEVICE_NEIGHBOR_METADATA[bgp_session['name']]['type'] %}
{% set neighbor_deployment_id = CONFIG_DB__DEVICE_NEIGHBOR_METADATA[bgp_session['name']]['deployment_id'] %}
{% set path_template = "bgpd/templates/msft.general/%s/" + template_name + ".conf.j2" %}
{% if neighbor_addr | ipv4 %}
{%     if device_type == 'MgmtToRRouter' %}
{%         include path_template % "v4.mgmttor" %}
{%     elif device_type == 'ToRRouter' %}
{%         if resource_type is defined and (resource_type == 'FPGASTP' or resource_type == 'SDNAPPLIANCE') %}
{%             include path_template % "v4.tor.rotterdam" %}
{%         else %}
{%             include path_template % "v4.tor" %}
{%         endif %}
{%     elif device_type == 'LeafRouter' %}
{%         if neighbor_type == 'SpineRouter' %}
{%             include path_template % "v4.leaf.spine" %}
{%         elif neighbor_type == 'ToRRouter' %}
{%             if neighbor_deployment_id is defined and neighbor_deployment_id == '26' %}
{%                 include path_template % "v4.leaf.tor.tycoon" %}
{%             else %}
{%                 include path_template % "v4.leaf.tor.all" %}
{%             endif %}
{%         elif neighbor_type == 'MseeRouter' %}
{%             include path_template % "v4.leaf.msee" %}
{%         endif %}
{%     endif %}
{% endif %}
{% if neighbor_addr | ipv6 %}
{%     if device_type == 'MgmtToRRouter' %}
{%         include path_template % "v6.mgmttor" %}
{%     elif device_type == 'ToRRouter' %}
{%         if resource_type is defined and (resource_type == 'FPGASTP' or resource_type == 'SDNAPPLIANCE') %}
{%             include path_template % "v6.tor.rotterdam" %}
{%         else %}
{%             include path_template % "v6.tor" %}
{%         endif %}
{%     elif device_type == 'LeafRouter' %}
{%         if neighbor_type == 'SpineRouter' %}
{%             include path_template % "v6.leaf.spine" %}
{%         elif neighbor_type == 'ToRRouter' %}
{%             if neighbor_deployment_id is defined and neighbor_deployment_id == '26' %}
{%                 include path_template % "v6.leaf.tor.tycoon" %}
{%             elif neighbor_deployment_id is defined and neighbor_deployment_id == '19' %}
{%                 include path_template % "v6.leaf.tor.dnsagg" %}
{%             elif neighbor_deployment_id is defined and neighbor_deployment_id == '21' %}
{%                 include path_template % "v6.leaf.tor.dnsagg" %}				
{%             else %}
{%                 include path_template % "v6.leaf.tor.all" %}
{%             endif %}
{%         elif neighbor_type == 'MseeRouter' %}
{%             include path_template % "v6.leaf.msee" %}
{%         endif %}
{%     endif %}
{% endif %}
{% endmacro %}
